<pre>{{ fullJson | json }}</pre>
<div id="box" class="{{menuClass}}">
    <div id="buttons">
        <div id="deco">
            <button class="bt" ng-click="edit()">Edit</button>
            <button class="bt" ng-click="open(fullJson.sources)">Add frame</button>
            <button class="bt" ng-click="saveJson()">Save</button>
            <label>
                <button class="bt" ng-click="addComp(newComp)">Add composition</button>
                <input ng-model="newComp">
            </label>
            <button class="bt" ng-click="logOut()">Logout</button>
        </div>
    </div>
    <ul id="tab">
        <li>
            <img id="arrow" ng-click="toggle('box');" ng-src="{{fullJson.menuarrow.arrowleft}}"/>
        </li>
    </ul>
</div>
<label>Composition
    <select ng-options="comp.name for comp in fullJson.user.compositions" ng-model="currentComp"></select>
</label>

<div ng-repeat="frame in currentComp.frames" class="outer">
    <ANY ng-switch on="frame.sourceType">
        <ANY ng-switch-when="1">
            <ANY ng-if="frame.type == 'stream'">
                <iframe id="frame{{currentComp.frames.indexOf(frame)}}" frameborder="0"
                        ng-src="{{trustSrc('http://www.goodgame.ru/player.php?'+frame.streamSource)}}"
                        ng-style="{'left':frame.positionX, 'top':frame.positionY, 'position': 'absolute', 'width':frame.width, 'height':frame.height}">
                </iframe>
            </ANY>
            <ANY ng-if="frame.type == 'chat'">
                <iframe id="frame{{currentComp.frames.indexOf(frame)}}" frameborder="0"
                        ng-src="{{trustSrc('http://www.goodgame.ru/chat/'+frame.streamSource)}}"
                        ng-style="{'left':frame.positionX, 'top':frame.positionY, 'position': 'absolute', 'width':frame.width, 'height':frame.height}">
                </iframe>
            </ANY>
        </ANY>
        <ANY ng-switch-when="0">
            <ANY ng-if="frame.type == 'stream'">
                <object type="application/x-shockwave-flash"
                        ng-style="{'left':frame.positionX, 'top':frame.positionY, 'position': 'absolute', 'width':frame.width, 'height':frame.height}"
                        id="frame{{currentComp.frames.indexOf(frame)}}"
                        data="http://www.twitch.tv/widgets/live_embed_player.swf?channel={CHANNEL}"
                        bgcolor="#000000">
                    <param name="allowFullScreen"
                           value="true"/>
                    <param name="allowScriptAccess"
                           value="always"/>
                    <param name="allowNetworking"
                           value="all"/>
                    <param name="movie"
                           value="http://www.twitch.tv/widgets/live_embed_player.swf"/>
                    <param name="flashvars"
                           value="hostname=www.twitch.tv&channel={{frame.streamSource}}"/>
                </object>
            </ANY>
            <ANY ng-if="frame.type == 'chat'">
                <iframe frameborder="0"
                        scrolling="no"
                        id="frame{{currentComp.frames.indexOf(frame)}}"
                        src="{{trustSrc('http://twitch.tv/chat/embed?channel='+frame.streamSource+'&amp;popout_chat=true')}}"
                        ng-style="{'left':frame.positionX, 'top':frame.positionY, 'position': 'absolute', 'width':frame.width, 'height':frame.height}">
                </iframe>
            </ANY>
        </ANY>
        <ANY ng-switch-when="2">
            <ANY ng-if="frame.type == 'stream'">
                <iframe id="frame{{currentComp.frames.indexOf(frame)}}" frameborder="0"
                        ng-src="{{trustSrc('http://api.cybergame.tv/p/embed.php?c='+frame.streamSource+'&w=200pc&h=100pc&type=embed')}}"
                        ng-style="{'left':frame.positionX, 'top':frame.positionY, 'position': 'absolute', 'width':frame.width, 'height':frame.height}">
                </iframe>
            </ANY>
            <ANY ng-if="frame.type == 'chat'">
                <iframe id="frame{{currentComp.frames.indexOf(frame)}}" frameborder="0"
                        ng-src="{{trustSrc('http://cybergame.tv/cgchat.htm?v=b#'+frame.streamSource)}}"
                        ng-style="{'left':frame.positionX, 'top':frame.positionY, 'position': 'absolute', 'width':frame.width, 'height':frame.height}">
                </iframe>
            </ANY>
        </ANY>
    </ANY>
    <div id="edit{{currentComp.frames.indexOf(frame)}}" resizable-draggable class="bar"
         ng-model="currentComp.frames[currentComp.frames.indexOf(frame)]"
         ng-style="{left:frame.positionX, top:frame.positionY, position: 'absolute', width:frame.width, height:frame.height}">
        <button class="close" style="font-size: 30px; padding: 10px;" ng-click="close(currentComp.frames, $index)">X</button>
    </div>
</div>
